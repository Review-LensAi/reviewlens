# convention-deviation

Detects code that deviates from conventions inferred from the existing repository, such as using `println!` instead of logging macros, calling `.unwrap()` or `.expect()`, or defining functions that do not return `Result` when all others do.

## Recommendation

Follow established repository patterns: prefer logging macros over `println!`, use proper error handling instead of `.unwrap()` or `.expect()`, and align function signatures with prevailing `Result`-based style.

## Configuration

```toml
[rules.convention-deviation]
enabled = true
severity = "medium"
```

## Suppression

Suppress a specific finding by using an inline directive:

```text
// reviewlens:ignore convention-deviation [reason]
```

The directive may appear on the line to suppress or on the immediately
preceding line. Any provided reason will be recorded in the logs.

## How indexing works

The scanner relies on a lightweight repository index generated by
`index_repository` in the `engine` crate. The indexer captures a
compact n‑gram embedding for each source file and extracts additional
metadata:

- **Function signatures** – used to infer whether functions typically
  return `Result` types.
- **Logging patterns** – lines that call logging or printing macros.
- **Error-handling snippets** – occurrences of `unwrap`, `expect`, and
  `Result` usage.

This enriched metadata allows the scanner to derive conventions without
parsing entire files on every run, improving accuracy and performance. The
index also records each file's last modification time so subsequent runs only
reprocess files that have changed. Use the CLI `index` command with
`--force` to discard the cache and rebuild the index from scratch.

